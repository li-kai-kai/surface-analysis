# XYZ文件分析工具 - 用户使用手册

## 📖 软件简介

XYZ文件分析工具是一款专业的光学表面误差分析软件,用于处理和分析XYZ格式的表面测量数据。

### 主要功能
- ✅ 去一阶面形分析 (PV值计算)
- ✅ NCE面形分析 (96场布局)
- ✅ SFMA分析 (动态移动狭缝模拟)
- ✅ 局部倾斜角度分析
- ✅ 可视化热力图生成
- ✅ 数据导出功能

---

## 🚀 快速开始

### 启动软件
1. 双击 `XYZ分析工具.exe` (Windows) 或 `XYZ分析工具` (macOS)
2. 等待2-3秒,浏览器会自动打开软件界面
3. 如果浏览器未自动打开,请手动访问: `http://localhost:8501`

### 基本使用流程
1. **上传文件**: 点击左侧"上传XYZ文件"按钮,选择您的 `.xyz` 文件
2. **设置参数**: 根据需要调整分析参数(可选)
3. **开始分析**: 点击"🚀 开始分析"按钮
4. **查看结果**: 在标签页中浏览各项分析结果
5. **下载结果**: 点击下载按钮保存图片和数据文件

---

## ⚙️ 参数说明

### 条屏狭缝宽度 (mm)
- **说明**: 扫描条屏的狭缝高度
- **默认值**: 8.0 mm
- **适用范围**: 1.0 - 50.0 mm
- **影响**: SFMA分析的窗口大小

### 子口径尺寸

#### sub_X (mm)
- **说明**: X方向的子口径尺寸(网格步长)
- **默认值**: 3.4 mm
- **适用范围**: 0.1 - 10.0 mm
- **影响**: 数据分箱的X方向分辨率

#### sub_Y (mm)
- **说明**: Y方向的子口径尺寸(网格步长)
- **默认值**: 0.5 mm
- **适用范围**: 0.01 - 5.0 mm
- **影响**: 数据分箱的Y方向分辨率

### 原始数据分辨率
- **说明**: 原始XYZ数据的像素到物理坐标的转换比例
- **默认值**: 0.000175
- **适用范围**: 0.00001 - 0.001
- **影响**: 像素坐标到米的转换系数

> **💡 提示**: 大多数情况下使用默认参数即可。如果您的数据来源不同,请咨询技术人员获取正确的参数值。

---

## 📊 结果解读

### 标签页1: 去一阶面形
- **显示内容**: 去除整体倾斜后的表面形貌
- **关键指标**: PV值 (峰谷值,单位: μm)
- **用途**: 评估表面的整体平整度

### 标签页2: NCE面形
- **显示内容**: 非可校正误差分布 (96场布局)
- **关键指标**: 3std值 (单位: nm)
- **用途**: 评估局部场内的表面误差

### 标签页3: SFMA分析
- **显示内容**: 动态移动狭缝模拟结果
- **关键指标**: Mean + 3std (单位: nm)
- **用途**: 模拟扫描过程中的表面误差

### 标签页4: 局部倾斜角度
- **显示内容**: 表面各点的局部倾斜角度
- **关键指标**: 
  - Max: 最大倾斜角度 (μrad)
  - Median + 3std: 统计指标 (μrad)
- **用途**: 评估表面的局部斜率变化

### 标签页5: 数据文件
- **显示内容**: 处理后的数据文本预览
- **格式**: 每行包含 X坐标 Y坐标 Z值
- **用途**: 用于进一步的数据分析或导入其他软件

---

## 🔧 常见问题

### Q1: 软件启动后浏览器没有自动打开?
**A**: 请手动打开浏览器,访问 `http://localhost:8501`

### Q2: 上传文件后提示错误?
**A**: 请检查:
- 文件格式是否为 `.xyz`
- 文件是否包含有效数据
- 文件编码是否正确

### Q3: 分析时间很长?
**A**: 这是正常现象。大型数据文件(>100万点)可能需要几分钟处理时间。

### Q4: 如何关闭软件?
**A**: 
1. 关闭浏览器标签页
2. 在任务栏找到程序图标,右键选择"退出"
3. 或直接在任务管理器中结束进程

### Q5: 参数应该如何设置?
**A**: 
- 如果不确定,使用默认参数
- 如果数据来源特殊,请咨询提供数据的技术人员
- 原始数据分辨率通常由测量设备决定

### Q6: 可以同时分析多个文件吗?
**A**: 当前版本不支持批量处理,请逐个文件分析。

---

## 📞 技术支持

如遇到问题,请提供以下信息:
1. 软件版本号
2. 操作系统版本
3. 错误截图或错误信息
4. 输入文件的大小和格式

---

## 📝 版本信息

**当前版本**: v1.0  
**发布日期**: 2025-11-26  
**支持平台**: Windows 10/11, macOS 10.15+

---

## ⚠️ 注意事项

1. **数据安全**: 所有数据处理均在本地完成,不会上传到云端
2. **文件大小**: 建议单个文件不超过500MB
3. **系统要求**: 
   - 内存: 建议8GB以上
   - 硬盘: 至少500MB可用空间
4. **浏览器兼容**: 推荐使用Chrome, Edge, Firefox最新版本

---

## 📄 许可协议

本软件仅供授权用户使用,未经许可不得复制、分发或修改。
